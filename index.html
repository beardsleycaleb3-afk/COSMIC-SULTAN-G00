<div id="tactile-zone">
  <div
    id="btn-rpm"
    class="actuator"
    ontouchstart="startRPMBoost()"
    ontouchend="stopRPMBoost()"
    ontouchcancel="stopRPMBoost()"
  >H</div>

<!-- SETTINGS OVERLAY -->
<div id="settings-panel" class="settings-overlay">
    <div class="settings-header">
        <span>‚öôÔ∏è SULTAN CONFIG</span>
        <button id="settings-close" class="close-btn">‚úï</button>
    </div>
    
    <!-- COLORS SECTION -->
    <div class="settings-section">
        <h4>üé® COLORS</h4>
        <div class="setting-row">
            <label>Core:</label>
            <input type="color" id="core-color" value="#00ff00">
        </div>
        <div class="setting-row">
            <label>Mid Ring:</label>
            <input type="color" id="mid-color" value="#ff6600">
        </div>
        <div class="setting-row">
            <label>HUD Magenta:</label>
            <input type="color" id="hud-magenta" value="#ff00ff">
        </div>
    </div>

    <!-- PHYSICS SECTION -->
    <div class="settings-section">
        <h4>‚öõÔ∏è PHYSICS</h4>
        <div class="setting-row">
            <label>Particles:</label>
            <input type="range" id="max-particles" min="500" max="5000" value="2500" step="500">
            <span id="particles-val">2500</span>
        </div>
        <div class="setting-row">
            <label>Gravity:</label>
            <input type="range" id="gravity-pull" min="0.5" max="2.0" value="1.2" step="0.1">
            <span id="gravity-val">1.2</span>
        </div>
    </div>

    <!-- AUDIO SECTION -->
    <div class="settings-section">
        <h4>üéµ AUDIO</h4>
        <div class="setting-row">
            <label>Waveform:</label>
            <select id="waveform">
                <option value="triangle">Triangle</option>
                <option value="sine">Sine</option>
                <option value="sawtooth">Sawtooth</option>
            </select>
        </div>
        <div class="setting-row">
            <label>Vibrato:</label>
            <input type="range" id="vibrato-speed" min="2" max="10" value="5.5" step="0.5">
            <span id="vibrato-val">5.5Hz</span>
        </div>
    </div>

    <!-- CONTROLS -->
    <div class="settings-footer">
        <button id="settings-save" class="save-btn">üíæ SAVE</button>
        <button id="settings-reset" class="reset-btn">üîÑ RESET</button>
        <button id="settings-back" class="back-btn">‚Üê BACK</button>
    </div>
</div>

<!-- SETTINGS TRIGGER BUTTON -->
<button id="settings-trigger" class="settings-tab">‚öôÔ∏è</button>

        renderer.render(scene, camera);
    }

    log("SULTAN_SOVEREIGN_1.6.2 ONLINE", "milestone");
    animate();
    if ('serviceWorker' in navigator) {
      navigator.serviceWorker.register('./sw.js');
    }
</script>



  
        renderer.render(scene, camera);
FIX ME", "milestone");
    animate();
    if ('serviceWorker' in navigator) navigator.serviceWorker.register('./sw.js');
</script> 
  <div id="btn-mute" class="actuator" ontouchstart="toggleMute()">¬©</div>
  <div id="btn-b" class="actuator" ontouchstart="manualCycle()">‚àÜ</div>
  <div id="btn-a" class="actuator" ontouchstart="injectParticles()">¬ß</div>
</div>// --- CORE LOGIC ---
const MAX_P = 2500; // was 2500000
const pData = new Array(MAX_P).fill(null).map(() => ({
  r: 1,
  a: 0,
  L: 1,
  active: false,
  burst: 0,
  color: [1, 1, 1]
}));

const posArr = new Float32Array(MAX_P * 3);  // was * 9
const colArr = new Float32Array(MAX_P * 3);

// in playTone()
const streamSpeed = Math.max(0.06, 0.2 - (rpm / 1500000)); // back to sane scaling

let freq = (rpm > 900000)
  ? healingFreqs[Math.floor(Math.random() * 3) + 6]
  : (rpm > 400000)
    ? 528
    : healingFreqs[Math.floor(Math.random() * 4)];

const bSize = audioCtx.sampleRate * 0.4; // ~0.4s noise burst

nGain.gain.setValueAtTime(0.015, now);
nGain.gain.exponentialRampToValueAtTime(0.0001, now + 0.3); // longer, audible breath

mGain.gain.setValueAtTime(0, now);
mGain.gain.linearRampToValueAtTime(0.12, now + 0.04);
mGain.gain.exponentialRampToValueAtTime(0.0001, now + 0.8);

osc.start();
noise.start();
osc.stop(now + 0.8);  // was 08.8
vibrato.stop(now + 0.8);
